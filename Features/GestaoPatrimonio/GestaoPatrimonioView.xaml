<Page
    x:Class="patrimonioDB.Features.GestaoPatrimonio.GestaoPatrimonioView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid Padding="20">
        <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
    <RowDefinition Height="*"/>
     </Grid.RowDefinitions>

        <!-- Cabecalho com Botao Voltar, Titulo e Botao Logout -->
        <Grid Grid.Row="0" Margin="0,0,0,20">
   <Grid.ColumnDefinitions>
       <ColumnDefinition Width="Auto"/>
    <ColumnDefinition Width="*"/>
           <ColumnDefinition Width="Auto"/>
   </Grid.ColumnDefinitions>

            <!-- Botao Voltar -->
     <Button 
           Grid.Column="0"
  x:Name="VoltarButton"
    Content="Voltar"
  Click="VoltarButton_Click"
     Background="Transparent"
      BorderThickness="0"
        VerticalAlignment="Center"
   Margin="0,0,20,0"/>

   <!-- Titulo -->
 <TextBlock 
     Grid.Column="1"
  Text="Gestao de Patrimonio" 
       FontSize="28" 
         FontWeight="Bold" 
    VerticalAlignment="Center"/>

       <!-- Botao Logout -->
          <Button 
    Grid.Column="2"
       x:Name="LogoutButton"
Content="Sair"
          Click="LogoutButton_Click"
             VerticalAlignment="Center"
       Background="Transparent"
  BorderBrush="{ThemeResource SystemControlForegroundBaseMediumBrush}"
     BorderThickness="1"/>
  </Grid>

        <!-- TabView com 3 abas -->
      <TabView Grid.Row="1" x:Name="MainTabView">

            <!-- ===== ABA 1: ADICIONAR ITEM ===== -->
  <TabView.TabItems>
     <TabViewItem Header="Adicionar Item">
         <ScrollViewer>
        <StackPanel Padding="20" Spacing="15" MaxWidth="600">

           <!-- Nome do Item -->
        <StackPanel Spacing="5">
    <TextBlock Text="Nome do Item:" FontWeight="SemiBold"/>
  <TextBox x:Name="NomeTextBox" PlaceholderText="Ex: Cadeira de Escritorio"/>
          </StackPanel>

                <!-- Descricao -->
         <StackPanel Spacing="5">
      <TextBlock Text="Descricao:" FontWeight="SemiBold"/>
         <TextBox x:Name="DescricaoTextBox" 
   PlaceholderText="Descricao detalhada do item"
      AcceptsReturn="True"
     TextWrapping="Wrap"
             Height="80"/>
                </StackPanel>

  <!-- Setor -->
     <StackPanel Spacing="5">
      <TextBlock Text="Setor:" FontWeight="SemiBold"/>
       <ComboBox x:Name="SetorComboBox" 
        PlaceholderText="Selecione o setor"
      HorizontalAlignment="Stretch"
      DisplayMemberPath="Nome"
     SelectedValuePath="Id"/>
          </StackPanel>

           <!-- Quantidade e Valor em Grid -->
                <Grid ColumnSpacing="10">
             <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
      <ColumnDefinition Width="*"/>
     </Grid.ColumnDefinitions>

              <!-- Quantidade -->
        <StackPanel Grid.Column="0" Spacing="5">
         <TextBlock Text="Quantidade:" FontWeight="SemiBold"/>
            <NumberBox x:Name="QuantidadeNumberBox" 
            Value="1" 
 Minimum="0"
        SpinButtonPlacementMode="Inline"/>
       </StackPanel>

          <!-- Valor Unitario -->
            <StackPanel Grid.Column="1" Spacing="5">
           <TextBlock Text="Valor Unitario (R$):" FontWeight="SemiBold"/>
            <NumberBox x:Name="ValorNumberBox" 
  Value="0" 
       Minimum="0"
      SpinButtonPlacementMode="Inline"/>
            </StackPanel>
            </Grid>

           <!-- Data de Compra -->
  <StackPanel Spacing="5">
        <TextBlock Text="Data de Compra:" FontWeight="SemiBold"/>
 <DatePicker x:Name="DataCompraDatePicker" HorizontalAlignment="Stretch"/>
       </StackPanel>

         <!-- Mensagens de Feedback -->
             <TextBlock x:Name="MensagemErroAdicionar"
     Foreground="Red"
   TextWrapping="Wrap"
      Visibility="Collapsed"/>

        <TextBlock x:Name="MensagemSucessoAdicionar"
Foreground="Green"
    TextWrapping="Wrap"
    Visibility="Collapsed"/>

   <!-- Loading -->
   <ProgressRing x:Name="LoadingRingAdicionar"
     IsActive="False"
       Visibility="Collapsed"
        Width="40"
          Height="40"
            HorizontalAlignment="Center"/>

       <!-- Botao Adicionar -->
        <Button x:Name="AdicionarButton"
     Content="Adicionar Item" 
          Click="AdicionarButton_Click"
       HorizontalAlignment="Stretch"
     Style="{StaticResource AccentButtonStyle}"/>

        </StackPanel>
  </ScrollViewer>
        </TabViewItem>

        <!-- ===== ABA 2: MOVER ITEM ===== -->
     <TabViewItem Header="Mover Item">
     <StackPanel Padding="20" Spacing="15">

<!-- Lista de Itens -->
     <StackPanel Spacing="5">
     <TextBlock Text="Selecione o item a mover:" FontWeight="SemiBold" FontSize="16"/>
    <TextBox x:Name="BuscarMoverTextBox" 
      PlaceholderText="Buscar por nome..."
        TextChanged="BuscarMover_TextChanged"/>
    </StackPanel>

       <ListView x:Name="ItensMoverListView"
  Height="250"
 SelectionMode="Single"
       SelectionChanged="ItensMoverListView_SelectionChanged">
          <ListView.ItemTemplate>
 <DataTemplate>
        <StackPanel Padding="10">
        <TextBlock Text="{Binding Nome}" FontWeight="Bold"/>
       <TextBlock Text="{Binding NomeSetor}" FontSize="12" Foreground="Gray"/>
    <TextBlock>
<Run Text="Qtd Disponível: "/>
  <Run Text="{Binding QuantidadeTotal}"/>
 <Run Text=" | Valor Médio: R$ "/>
    <Run Text="{Binding ValorUnitarioMedio}"/>
     </TextBlock>
      </StackPanel>
  </DataTemplate>
     </ListView.ItemTemplate>
    </ListView>

<!-- Quantidade a Mover -->
     <StackPanel Spacing="5">
<TextBlock Text="Quantidade a mover:" FontWeight="SemiBold"/>
<NumberBox x:Name="QuantidadeMoverNumberBox" 
 Value="1" 
           Minimum="1"
    SpinButtonPlacementMode="Inline"
  HorizontalAlignment="Stretch"/>
</StackPanel>

  <!-- Novo Setor -->
     <StackPanel Spacing="5">
       <TextBlock Text="Mover para o setor:" FontWeight="SemiBold"/>
      <ComboBox x:Name="NovoSetorComboBox" 
    PlaceholderText="Selecione o novo setor"
      HorizontalAlignment="Stretch"
  DisplayMemberPath="Nome"
SelectedValuePath="Id"/>
      </StackPanel>

<!-- Mensagens -->
   <TextBlock x:Name="MensagemErroMover"
      Foreground="Red"
     TextWrapping="Wrap"
                 Visibility="Collapsed"/>

  <TextBlock x:Name="MensagemSucessoMover"
     Foreground="Green"
             TextWrapping="Wrap"
           Visibility="Collapsed"/>

    <!-- Loading -->
 <ProgressRing x:Name="LoadingRingMover"
  IsActive="False"
          Visibility="Collapsed"
   Width="40"
       Height="40"
  HorizontalAlignment="Center"/>

  <!-- Botao Mover -->
       <Button x:Name="MoverButton"
  Content="Mover Item" 
 Click="MoverButton_Click"
 HorizontalAlignment="Stretch"
   Style="{StaticResource AccentButtonStyle}"
IsEnabled="False"/>

   </StackPanel>
    </TabViewItem>

    <!-- ===== ABA 3: VENDER ITEM ===== -->
     <TabViewItem Header="Vender Item">
<StackPanel Padding="20" Spacing="15">

    <!-- Aviso Importante -->
     <Border 
   Background="{ThemeResource SystemFillColorAttentionBackgroundBrush}"
 BorderBrush="{ThemeResource SystemFillColorAttentionBrush}"
 BorderThickness="1"
      CornerRadius="4"
  Padding="10"
   Margin="0,0,0,10">
     <StackPanel Spacing="5">
 <TextBlock Text="?? Importante" FontWeight="Bold"/>
 <TextBlock Text="Remover um item registra uma VENDA no sistema. Você pode escolher a quantidade. O item permanece no histórico do banco de dados."
           TextWrapping="Wrap"
 FontSize="12"/>
     </StackPanel>
 </Border>

  <!-- Lista de Itens Ativos -->
 <StackPanel Spacing="5">
<TextBlock Text="Selecione o item a vender:" FontWeight="SemiBold" FontSize="16"/>
     <TextBox x:Name="BuscarRemoverTextBox" 
 PlaceholderText="Buscar por nome..."
   TextChanged="BuscarRemover_TextChanged"/>
  </StackPanel>

   <ListView x:Name="ItensRemoverListView"
 Height="250"
SelectionMode="Single"
  SelectionChanged="ItensRemoverListView_SelectionChanged">
  <ListView.ItemTemplate>
  <DataTemplate>
 <StackPanel Padding="10">
 <TextBlock Text="{Binding Nome}" FontWeight="Bold"/>
  <TextBlock Text="{Binding NomeSetor}" FontSize="12" Foreground="Gray"/>
  <TextBlock>
      <Run Text="Estoque: "/>
 <Run Text="{Binding QuantidadeTotal}" FontWeight="SemiBold" Foreground="Green"/>
  <Run Text=" unidades | Preço Médio: R$ "/>
    <Run Text="{Binding ValorUnitarioMedio}"/>
</TextBlock>
  </StackPanel>
       </DataTemplate>
  </ListView.ItemTemplate>
   </ListView>

    <!-- Quantidade a Vender -->
    <StackPanel Spacing="5">
  <TextBlock Text="Quantidade a vender:" FontWeight="SemiBold"/>
        <NumberBox x:Name="QuantidadeVenderNumberBox" 
       Value="1" 
 Minimum="1"
  SpinButtonPlacementMode="Inline"
         HorizontalAlignment="Stretch"
         PlaceholderText="Quantidade a vender"/>
    </StackPanel>

    <!-- Mensagens -->
     <TextBlock x:Name="MensagemErroRemover"
   Foreground="Red"
    TextWrapping="Wrap"
 Visibility="Collapsed"/>

<TextBlock x:Name="MensagemSucessoRemover"
    Foreground="Green"
      TextWrapping="Wrap"
   Visibility="Collapsed"/>

   <!-- Loading -->
    <ProgressRing x:Name="LoadingRingRemover"
   IsActive="False"
 Visibility="Collapsed"
   Width="40"
     Height="40"
    HorizontalAlignment="Center"/>

  <!-- Botao Vender -->
     <Button x:Name="RemoverButton"
   Content="Vender Item (Remover do Estoque)" 
  Click="RemoverButton_Click"
     HorizontalAlignment="Stretch"
 Background="Red"
    IsEnabled="False"/>

 </StackPanel>
         </TabViewItem>

        <!-- ===== ABA 4: RECOMPRAR ITEM ===== -->
         <TabViewItem Header="Recomprar Item">
          <ScrollViewer>
<StackPanel Padding="20" Spacing="15" MaxWidth="600">

      <!-- Aviso -->
   <Border 
    Background="{ThemeResource SystemFillColorSuccessBackgroundBrush}"
         BorderBrush="{ThemeResource SystemFillColorSuccessBrush}"
  BorderThickness="1"
       CornerRadius="4"
   Padding="10"
    Margin="0,0,0,10">
     <StackPanel Spacing="5">
    <TextBlock Text="?? Dica" FontWeight="Bold"/>
   <TextBlock Text="Recomprar incrementa o estoque de um item existente. Útil quando você compra mais unidades de algo que já possui."
 TextWrapping="Wrap"
   FontSize="12"/>
        </StackPanel>
 </Border>

    <!-- Buscar Item -->
      <StackPanel Spacing="5">
  <TextBlock Text="Buscar item para recomprar:" FontWeight="SemiBold" FontSize="16"/>
    <TextBox x:Name="BuscarRecompraTextBox" 
      PlaceholderText="Buscar por nome..."
   TextChanged="BuscarRecompra_TextChanged"/>
     </StackPanel>

     <!-- Lista de Itens -->
  <ListView x:Name="ItensRecompraListView"
             Height="200"
     SelectionMode="Single"
    SelectionChanged="ItensRecompraListView_SelectionChanged">
            <ListView.ItemTemplate>
  <DataTemplate>
  <StackPanel Padding="10">
    <TextBlock Text="{Binding Nome}" FontWeight="Bold"/>
     <TextBlock Text="{Binding NomeSetor}" FontSize="12" Foreground="Gray"/>
        <TextBlock>
     <Run Text="Estoque atual: "/>
          <Run Text="{Binding QuantidadeTotal}"/>
         <Run Text=" | ID: "/>
        <Run Text="{Binding Id}"/>
</TextBlock>
       </StackPanel>
   </DataTemplate>
      </ListView.ItemTemplate>
    </ListView>

  <!-- Quantidade -->
       <StackPanel Spacing="5">
           <TextBlock Text="Quantidade a comprar:" FontWeight="SemiBold"/>
       <NumberBox x:Name="QuantidadeRecompraNumberBox" 
     Value="1" 
  Minimum="1"
  SpinButtonPlacementMode="Inline"/>
        </StackPanel>

         <!-- Preço -->
    <StackPanel Spacing="5">
      <TextBlock Text="Preço unitário (R$):" FontWeight="SemiBold"/>
 <NumberBox x:Name="PrecoRecompraNumberBox" 
     Value="0" 
   Minimum="0"
   SpinButtonPlacementMode="Inline"/>
       </StackPanel>

  <!-- Mensagens -->
         <TextBlock x:Name="MensagemErroRecompra"
    Foreground="Red"
         TextWrapping="Wrap"
           Visibility="Collapsed"/>

    <TextBlock x:Name="MensagemSucessoRecompra"
  Foreground="Green"
   TextWrapping="Wrap"
     Visibility="Collapsed"/>

    <!-- Loading -->
  <ProgressRing x:Name="LoadingRingRecompra"
    IsActive="False"
 Visibility="Collapsed"
    Width="40"
   Height="40"
    HorizontalAlignment="Center"/>

     <!-- Botao Recomprar -->
        <Button x:Name="RecomprarButton"
 Content="Registrar Recompra" 
  Click="RecomprarButton_Click"
       HorizontalAlignment="Stretch"
      Style="{StaticResource AccentButtonStyle}"
    IsEnabled="False"/>

</StackPanel>
     </ScrollViewer>
   </TabViewItem>

 </TabView.TabItems>
      </TabView>
    </Grid>
</Page>
